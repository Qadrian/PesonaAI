{"ast":null,"code":"import{useEffect,useRef,useState}from'react';import{apiFetch}from'../api/api';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function ChatBox(_ref){let{topic}=_ref;const[chats,setChats]=useState([]);const[message,setMessage]=useState('');const chatRef=useRef();useEffect(()=>{if(topic){apiFetch(\"/chats/\".concat(topic.id)).then(setChats);}},[topic]);const sendMessage=async e=>{e.preventDefault();if(!message)return;await apiFetch(\"/chats/\".concat(topic.id),{method:'POST',body:JSON.stringify({sender:'user',message})});setChats([...chats,{sender:'user',message}]);setMessage('');// Simulasi balasan bot\nsetTimeout(()=>{setChats(c=>[...c,{sender:'bot',message:'Bot response...'}]);},1000);};useEffect(()=>{if(chatRef.current)chatRef.current.scrollTop=chatRef.current.scrollHeight;},[chats]);if(!topic)return/*#__PURE__*/_jsx(\"div\",{className:\"flex-1 flex items-center justify-center text-gray-400\",children:\"Pilih topik untuk mulai chat\"});return/*#__PURE__*/_jsxs(\"div\",{className:\"flex-1 flex flex-col\",children:[/*#__PURE__*/_jsx(\"div\",{ref:chatRef,className:\"flex-1 overflow-y-auto p-4\",children:chats.map((c,i)=>/*#__PURE__*/_jsx(\"div\",{className:\"mb-2 \".concat(c.sender==='user'?'text-right':'text-left'),children:/*#__PURE__*/_jsx(\"span\",{className:\"inline-block px-3 py-2 rounded \".concat(c.sender==='user'?'bg-blue-500 text-white':'bg-gray-200 text-black'),children:c.message})},i))}),/*#__PURE__*/_jsxs(\"form\",{className:\"flex p-4 border-t\",onSubmit:sendMessage,children:[/*#__PURE__*/_jsx(\"input\",{className:\"flex-1 p-2 rounded border\",value:message,onChange:e=>setMessage(e.target.value),placeholder:\"Type a message...\"}),/*#__PURE__*/_jsx(\"button\",{className:\"ml-2 bg-blue-600 text-white px-4 py-2 rounded\",type:\"submit\",children:\"Send\"})]})]});}","map":{"version":3,"names":["useEffect","useRef","useState","apiFetch","jsx","_jsx","jsxs","_jsxs","ChatBox","_ref","topic","chats","setChats","message","setMessage","chatRef","concat","id","then","sendMessage","e","preventDefault","method","body","JSON","stringify","sender","setTimeout","c","current","scrollTop","scrollHeight","className","children","ref","map","i","onSubmit","value","onChange","target","placeholder","type"],"sources":["/root/PesonaAI/src/components/ChatBox.jsx"],"sourcesContent":["import { useEffect, useRef, useState } from 'react';\nimport { apiFetch } from '../api/api';\n\nexport default function ChatBox({ topic }) {\n  const [chats, setChats] = useState([]);\n  const [message, setMessage] = useState('');\n  const chatRef = useRef();\n\n  useEffect(() => {\n    if (topic) {\n      apiFetch(`/chats/${topic.id}`).then(setChats);\n    }\n  }, [topic]);\n\n  const sendMessage = async e => {\n    e.preventDefault();\n    if (!message) return;\n    await apiFetch(`/chats/${topic.id}`, { method: 'POST', body: JSON.stringify({ sender: 'user', message }) });\n    setChats([...chats, { sender: 'user', message }]);\n    setMessage('');\n    // Simulasi balasan bot\n    setTimeout(() => {\n      setChats(c => [...c, { sender: 'bot', message: 'Bot response...' }]);\n    }, 1000);\n  };\n\n  useEffect(() => {\n    if (chatRef.current) chatRef.current.scrollTop = chatRef.current.scrollHeight;\n  }, [chats]);\n\n  if (!topic) return <div className=\"flex-1 flex items-center justify-center text-gray-400\">Pilih topik untuk mulai chat</div>;\n\n  return (\n    <div className=\"flex-1 flex flex-col\">\n      <div ref={chatRef} className=\"flex-1 overflow-y-auto p-4\">\n        {chats.map((c, i) => (\n          <div key={i} className={`mb-2 ${c.sender === 'user' ? 'text-right' : 'text-left'}`}>\n            <span className={`inline-block px-3 py-2 rounded ${c.sender === 'user' ? 'bg-blue-500 text-white' : 'bg-gray-200 text-black'}`}>{c.message}</span>\n          </div>\n        ))}\n      </div>\n      <form className=\"flex p-4 border-t\" onSubmit={sendMessage}>\n        <input className=\"flex-1 p-2 rounded border\" value={message} onChange={e => setMessage(e.target.value)} placeholder=\"Type a message...\" />\n        <button className=\"ml-2 bg-blue-600 text-white px-4 py-2 rounded\" type=\"submit\">Send</button>\n      </form>\n    </div>\n  );\n} "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}